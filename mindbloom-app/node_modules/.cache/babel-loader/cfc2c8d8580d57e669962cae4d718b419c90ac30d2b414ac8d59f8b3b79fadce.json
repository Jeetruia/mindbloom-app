{"ast":null,"code":"// Speech types are defined globally\n// Simplified Text-to-Speech Service\nexport class TTSService{constructor(){this.synthesis=void 0;this.voices=[];this.currentVoice=null;this.synthesis=window.speechSynthesis;this.loadVoices();}loadVoices(){this.voices=this.synthesis.getVoices();// Prefer female voices for therapist persona\nthis.currentVoice=this.voices.find(voice=>voice.name.includes('Female')||voice.name.includes('Karen')||voice.name.includes('Samantha')||voice.name.includes('Zira'))||this.voices[0];}async speak(text){let options=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};return new Promise((resolve,reject)=>{if(!this.synthesis){reject(new Error('Speech synthesis not supported'));return;}// Cancel any ongoing speech\nthis.synthesis.cancel();const utterance=new SpeechSynthesisUtterance(text);if(this.currentVoice){utterance.voice=this.currentVoice;}utterance.rate=options.rate||0.9;utterance.pitch=options.pitch||1.0;utterance.volume=options.volume||1.0;utterance.onend=()=>resolve();utterance.onerror=event=>reject(event.error);this.synthesis.speak(utterance);});}stop(){this.synthesis.cancel();}pause(){this.synthesis.pause();}resume(){this.synthesis.resume();}isSpeaking(){return this.synthesis.speaking;}getAvailableVoices(){return this.voices;}setVoice(voice){this.currentVoice=voice;}}// Simplified Speech-to-Text Service\nexport class STTService{constructor(){this.recognition=null;this.isListening=false;if('webkitSpeechRecognition'in window||'SpeechRecognition'in window){const SpeechRecognitionClass=window.SpeechRecognition||window.webkitSpeechRecognition;this.recognition=new SpeechRecognitionClass();if(this.recognition){this.recognition.continuous=false;this.recognition.interimResults=true;this.recognition.lang='en-US';}}}async startListening(){return new Promise((resolve,reject)=>{if(!this.recognition){reject(new Error('Speech recognition not supported'));return;}this.isListening=true;this.recognition.onresult=event=>{const transcript=Array.from(event.results).map(result=>result[0]).map(result=>result.transcript).join('');if(event.results[0].isFinal){this.isListening=false;resolve(transcript);}};this.recognition.onerror=event=>{this.isListening=false;reject(new Error(event.error));};this.recognition.onend=()=>{this.isListening=false;};this.recognition.start();});}stopListening(){if(this.recognition&&this.isListening){this.recognition.stop();this.isListening=false;}}isCurrentlyListening(){return this.isListening;}setLanguage(lang){if(this.recognition){this.recognition.lang=lang;}}}// Simplified Lip Sync Service\nexport class LipSyncService{constructor(){this.audioContext=null;try{this.audioContext=new(window.AudioContext||window.webkitAudioContext)();}catch(error){console.warn('Audio context not supported:',error);}}// Simplified viseme generation based on text analysis\ngenerateVisemesFromText(text){const visemes=[];const words=text.toLowerCase().split(/\\s+/);const timePerWord=0.3;// 300ms per word\nlet currentTime=0;for(const word of words){const phoneme=this.textToPhoneme(word);const duration=Math.max(0.1,word.length*0.05);// Minimum 100ms\nvisemes.push({phoneme,startTime:currentTime,endTime:currentTime+duration});currentTime+=duration+0.1;// Small pause between words\n}return visemes;}textToPhoneme(word){// Simplified phoneme mapping based on common sounds\nif(word.includes('a')||word.includes('e')||word.includes('i')||word.includes('o')||word.includes('u')){return'A';// Open mouth sounds\n}else if(word.includes('m')||word.includes('b')||word.includes('p')){return'M';// Closed mouth sounds\n}else if(word.includes('f')||word.includes('v')){return'F';// Lip-teeth sounds\n}else if(word.includes('th')){return'TH';// Tongue sounds\n}else{return'A';// Default to open mouth\n}}connectToAudioElement(audioElement){if(!this.audioContext)return;try{const source=this.audioContext.createMediaElementSource(audioElement);source.connect(this.audioContext.destination);}catch(error){console.warn('Could not connect audio element:',error);}}getAudioLevel(){// Simplified audio level detection\nreturn Math.random()*0.5+0.3;// Random level between 0.3 and 0.8\n}}","map":{"version":3,"names":["TTSService","constructor","synthesis","voices","currentVoice","window","speechSynthesis","loadVoices","getVoices","find","voice","name","includes","speak","text","options","arguments","length","undefined","Promise","resolve","reject","Error","cancel","utterance","SpeechSynthesisUtterance","rate","pitch","volume","onend","onerror","event","error","stop","pause","resume","isSpeaking","speaking","getAvailableVoices","setVoice","STTService","recognition","isListening","SpeechRecognitionClass","SpeechRecognition","webkitSpeechRecognition","continuous","interimResults","lang","startListening","onresult","transcript","Array","from","results","map","result","join","isFinal","start","stopListening","isCurrentlyListening","setLanguage","LipSyncService","audioContext","AudioContext","webkitAudioContext","console","warn","generateVisemesFromText","visemes","words","toLowerCase","split","timePerWord","currentTime","word","phoneme","textToPhoneme","duration","Math","max","push","startTime","endTime","connectToAudioElement","audioElement","source","createMediaElementSource","connect","destination","getAudioLevel","random"],"sources":["/Users/jeetruia/MINDBLOOM/mindbloom-app/src/services/speechServiceSimple.ts"],"sourcesContent":["// Speech types are defined globally\n\n// Simplified Text-to-Speech Service\nexport class TTSService {\n  private synthesis: SpeechSynthesis;\n  private voices: SpeechSynthesisVoice[] = [];\n  private currentVoice: SpeechSynthesisVoice | null = null;\n\n  constructor() {\n    this.synthesis = window.speechSynthesis;\n    this.loadVoices();\n  }\n\n  private loadVoices() {\n    this.voices = this.synthesis.getVoices();\n    \n    // Prefer female voices for therapist persona\n    this.currentVoice = this.voices.find(voice => \n      voice.name.includes('Female') || \n      voice.name.includes('Karen') || \n      voice.name.includes('Samantha') ||\n      voice.name.includes('Zira')\n    ) || this.voices[0];\n  }\n\n  async speak(text: string, options: {\n    rate?: number;\n    pitch?: number;\n    volume?: number;\n  } = {}): Promise<void> {\n    return new Promise((resolve, reject) => {\n      if (!this.synthesis) {\n        reject(new Error('Speech synthesis not supported'));\n        return;\n      }\n\n      // Cancel any ongoing speech\n      this.synthesis.cancel();\n\n      const utterance = new SpeechSynthesisUtterance(text);\n      \n      if (this.currentVoice) {\n        utterance.voice = this.currentVoice;\n      }\n\n      utterance.rate = options.rate || 0.9;\n      utterance.pitch = options.pitch || 1.0;\n      utterance.volume = options.volume || 1.0;\n\n      utterance.onend = () => resolve();\n      utterance.onerror = (event) => reject(event.error);\n\n      this.synthesis.speak(utterance);\n    });\n  }\n\n  stop() {\n    this.synthesis.cancel();\n  }\n\n  pause() {\n    this.synthesis.pause();\n  }\n\n  resume() {\n    this.synthesis.resume();\n  }\n\n  isSpeaking(): boolean {\n    return this.synthesis.speaking;\n  }\n\n  getAvailableVoices(): SpeechSynthesisVoice[] {\n    return this.voices;\n  }\n\n  setVoice(voice: SpeechSynthesisVoice) {\n    this.currentVoice = voice;\n  }\n}\n\n// Simplified Speech-to-Text Service\nexport class STTService {\n  private recognition: SpeechRecognition | null = null;\n  private isListening = false;\n\n  constructor() {\n    if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {\n      const SpeechRecognitionClass = (window as any).SpeechRecognition || (window as any).webkitSpeechRecognition;\n      this.recognition = new SpeechRecognitionClass();\n      \n      if (this.recognition) {\n        this.recognition.continuous = false;\n        this.recognition.interimResults = true;\n        this.recognition.lang = 'en-US';\n      }\n    }\n  }\n\n  async startListening(): Promise<string> {\n    return new Promise((resolve, reject) => {\n      if (!this.recognition) {\n        reject(new Error('Speech recognition not supported'));\n        return;\n      }\n\n      this.isListening = true;\n\n      this.recognition.onresult = (event: SpeechRecognitionEvent) => {\n        const transcript = Array.from(event.results)\n          .map(result => result[0])\n          .map(result => result.transcript)\n          .join('');\n\n        if (event.results[0].isFinal) {\n          this.isListening = false;\n          resolve(transcript);\n        }\n      };\n\n      this.recognition.onerror = (event: SpeechRecognitionErrorEvent) => {\n        this.isListening = false;\n        reject(new Error(event.error));\n      };\n\n      this.recognition.onend = () => {\n        this.isListening = false;\n      };\n\n      this.recognition.start();\n    });\n  }\n\n  stopListening() {\n    if (this.recognition && this.isListening) {\n      this.recognition.stop();\n      this.isListening = false;\n    }\n  }\n\n  isCurrentlyListening(): boolean {\n    return this.isListening;\n  }\n\n  setLanguage(lang: string) {\n    if (this.recognition) {\n      this.recognition.lang = lang;\n    }\n  }\n}\n\n// Simplified Lip Sync Service\nexport class LipSyncService {\n  private audioContext: AudioContext | null = null;\n\n  constructor() {\n    try {\n      this.audioContext = new (window.AudioContext || (window as any).webkitAudioContext)();\n    } catch (error) {\n      console.warn('Audio context not supported:', error);\n    }\n  }\n\n  // Simplified viseme generation based on text analysis\n  generateVisemesFromText(text: string): Array<{phoneme: string, startTime: number, endTime: number}> {\n    const visemes = [];\n    const words = text.toLowerCase().split(/\\s+/);\n    const timePerWord = 0.3; // 300ms per word\n    \n    let currentTime = 0;\n    \n    for (const word of words) {\n      const phoneme = this.textToPhoneme(word);\n      const duration = Math.max(0.1, word.length * 0.05); // Minimum 100ms\n      \n      visemes.push({\n        phoneme,\n        startTime: currentTime,\n        endTime: currentTime + duration\n      });\n      \n      currentTime += duration + 0.1; // Small pause between words\n    }\n    \n    return visemes;\n  }\n\n  private textToPhoneme(word: string): string {\n    // Simplified phoneme mapping based on common sounds\n    if (word.includes('a') || word.includes('e') || word.includes('i') || word.includes('o') || word.includes('u')) {\n      return 'A'; // Open mouth sounds\n    } else if (word.includes('m') || word.includes('b') || word.includes('p')) {\n      return 'M'; // Closed mouth sounds\n    } else if (word.includes('f') || word.includes('v')) {\n      return 'F'; // Lip-teeth sounds\n    } else if (word.includes('th')) {\n      return 'TH'; // Tongue sounds\n    } else {\n      return 'A'; // Default to open mouth\n    }\n  }\n\n  connectToAudioElement(audioElement: HTMLAudioElement) {\n    if (!this.audioContext) return;\n\n    try {\n      const source = this.audioContext.createMediaElementSource(audioElement);\n      source.connect(this.audioContext.destination);\n    } catch (error) {\n      console.warn('Could not connect audio element:', error);\n    }\n  }\n\n  getAudioLevel(): number {\n    // Simplified audio level detection\n    return Math.random() * 0.5 + 0.3; // Random level between 0.3 and 0.8\n  }\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}