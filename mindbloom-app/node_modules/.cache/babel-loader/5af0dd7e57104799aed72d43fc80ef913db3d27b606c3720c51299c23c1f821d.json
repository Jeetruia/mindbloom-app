{"ast":null,"code":"import React,{useState,useEffect,useRef}from'react';import{motion,AnimatePresence}from'framer-motion';import{Send,Mic,MicOff,Volume2,VolumeX,Bot,User,Loader2}from'lucide-react';import{botpressService}from'../services/botpressService';import{useStore}from'../hooks/useStore';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export function BotpressChat(_ref){let{onMessage,onSpeaking}=_ref;const{user,addMessage,messages,isListening,startListening,stopListening,speakText}=useStore();const[inputMessage,setInputMessage]=useState('');const[isConnected,setIsConnected]=useState(false);const[isLoading,setIsLoading]=useState(false);const[isSpeaking,setIsSpeaking]=useState(false);const[isMuted,setIsMuted]=useState(false);const messagesEndRef=useRef(null);const speechSynthesis=useRef(null);useEffect(()=>{initializeBotpress();},[]);useEffect(()=>{scrollToBottom();},[messages]);const initializeBotpress=async()=>{try{await botpressService.initialize();setIsConnected(true);// Get initial greeting from Botpress\nconst greeting=await botpressService.getInitialGreeting();if(greeting&&greeting.length>0){const greetingMessage=greeting[0];addMessage({id:greetingMessage.id,userId:(user===null||user===void 0?void 0:user.id)||'anonymous',content:greetingMessage.text||'Hello! I\\'m Mira, your wellness guide.',isFromUser:false,timestamp:new Date(),emotion:{type:'welcoming',intensity:0.8}});// Speak the greeting\nif(greetingMessage.text){speakMessage(greetingMessage.text);}}}catch(error){console.error('Failed to initialize Botpress:',error);setIsConnected(false);}};const speakMessage=text=>{if(isMuted||isSpeaking)return;setIsSpeaking(true);onSpeaking(true);// Stop any current speech\nif(speechSynthesis.current){window.speechSynthesis.cancel();}const utterance=new SpeechSynthesisUtterance(text);utterance.rate=0.9;utterance.pitch=1.1;utterance.volume=0.8;utterance.onstart=()=>{setIsSpeaking(true);onSpeaking(true);};utterance.onend=()=>{setIsSpeaking(false);onSpeaking(false);};utterance.onerror=()=>{setIsSpeaking(false);onSpeaking(false);};speechSynthesis.current=utterance;speechSynthesis.speak(utterance);};const handleSendMessage=async()=>{if(!inputMessage.trim()||isLoading)return;const userMessage=inputMessage.trim();setInputMessage('');setIsLoading(true);// Add user message\nconst userMsg={id:\"user_\".concat(Date.now()),userId:(user===null||user===void 0?void 0:user.id)||'anonymous',content:userMessage,isFromUser:true,timestamp:new Date(),emotion:{type:'neutral',intensity:0.5}};addMessage(userMsg);onMessage(userMessage,true);try{// Send to Botpress\nconst responses=await botpressService.sendMessage(userMessage);if(responses&&responses.length>0){for(const response of responses){if(response.text){const botMsg={id:response.id,userId:(user===null||user===void 0?void 0:user.id)||'anonymous',content:response.text,isFromUser:false,timestamp:new Date(),emotion:{type:'encouraging',intensity:0.7}};addMessage(botMsg);onMessage(response.text,false);// Speak the response\nspeakMessage(response.text);}}}}catch(error){console.error('Error sending message to Botpress:',error);// Fallback response\nconst fallbackMsg={id:\"fallback_\".concat(Date.now()),userId:(user===null||user===void 0?void 0:user.id)||'anonymous',content:\"I'm here to listen and support you. How are you feeling today?\",isFromUser:false,timestamp:new Date(),emotion:{type:'encouraging',intensity:0.6}};addMessage(fallbackMsg);onMessage(fallbackMsg.content,false);speakMessage(fallbackMsg.content);}finally{setIsLoading(false);}};const handleVoiceInput=()=>{if(isListening){stopListening();}else{startListening();}};const handleKeyPress=e=>{if(e.key==='Enter'&&!e.shiftKey){e.preventDefault();handleSendMessage();}};const scrollToBottom=()=>{var _messagesEndRef$curre;(_messagesEndRef$curre=messagesEndRef.current)===null||_messagesEndRef$curre===void 0?void 0:_messagesEndRef$curre.scrollIntoView({behavior:'smooth'});};const toggleMute=()=>{setIsMuted(!isMuted);if(isSpeaking){speechSynthesis.cancel();setIsSpeaking(false);onSpeaking(false);}};return/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col h-full bg-white\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"p-4 border-b border-gray-200 bg-gradient-to-r from-blue-500 to-purple-500 text-white\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-3\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-10 h-10 bg-white/20 rounded-full flex items-center justify-center\",children:/*#__PURE__*/_jsx(Bot,{className:\"w-6 h-6\"})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{className:\"font-semibold\",children:\"Mira - Your Wellness Guide\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-white/80\",children:isConnected?'Connected':'Connecting...'})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:toggleMute,className:\"p-2 rounded-lg transition-colors \".concat(isMuted?'bg-red-500/20 text-red-200':'bg-white/20 text-white'),title:isMuted?'Unmute':'Mute',children:isMuted?/*#__PURE__*/_jsx(VolumeX,{className:\"w-4 h-4\"}):/*#__PURE__*/_jsx(Volume2,{className:\"w-4 h-4\"})}),isSpeaking&&/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-1 text-white/80\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-2 h-2 bg-white rounded-full animate-pulse\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-xs\",children:\"Speaking\"})]})]})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1 overflow-y-auto p-4 space-y-4\",children:[/*#__PURE__*/_jsx(AnimatePresence,{children:messages.map(message=>/*#__PURE__*/_jsx(motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:\"flex \".concat(message.isFromUser?'justify-end':'justify-start'),children:/*#__PURE__*/_jsx(\"div\",{className:\"max-w-xs lg:max-w-md px-4 py-2 rounded-2xl \".concat(message.isFromUser?'bg-blue-500 text-white':'bg-gray-100 text-gray-800'),children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start space-x-2\",children:[!message.isFromUser&&/*#__PURE__*/_jsx(\"div\",{className:\"w-6 h-6 bg-gradient-to-br from-blue-400 to-purple-400 rounded-full flex items-center justify-center flex-shrink-0 mt-1\",children:/*#__PURE__*/_jsx(Bot,{className:\"w-3 h-3 text-white\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm\",children:message.content}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs opacity-70 mt-1\",children:message.timestamp.toLocaleTimeString([],{hour:'2-digit',minute:'2-digit'})})]}),message.isFromUser&&/*#__PURE__*/_jsx(\"div\",{className:\"w-6 h-6 bg-gradient-to-br from-green-400 to-blue-400 rounded-full flex items-center justify-center flex-shrink-0 mt-1\",children:/*#__PURE__*/_jsx(User,{className:\"w-3 h-3 text-white\"})})]})})},message.id))}),isLoading&&/*#__PURE__*/_jsx(motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:\"flex justify-start\",children:/*#__PURE__*/_jsx(\"div\",{className:\"bg-gray-100 text-gray-800 px-4 py-2 rounded-2xl\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[/*#__PURE__*/_jsx(Loader2,{className:\"w-4 h-4 animate-spin\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sm\",children:\"Mira is thinking...\"})]})})}),/*#__PURE__*/_jsx(\"div\",{ref:messagesEndRef})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"p-4 border-t border-gray-200 bg-gray-50\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-end space-x-2\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex-1\",children:/*#__PURE__*/_jsx(\"textarea\",{value:inputMessage,onChange:e=>setInputMessage(e.target.value),onKeyPress:handleKeyPress,placeholder:\"Type your message...\",className:\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none\",rows:1,style:{minHeight:'40px',maxHeight:'120px'}})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-2\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:handleVoiceInput,className:\"p-2 rounded-lg transition-colors \".concat(isListening?'bg-red-500 text-white':'bg-gray-200 text-gray-600 hover:bg-gray-300'),title:isListening?'Stop listening':'Start voice input',children:isListening?/*#__PURE__*/_jsx(MicOff,{className:\"w-5 h-5\"}):/*#__PURE__*/_jsx(Mic,{className:\"w-5 h-5\"})}),/*#__PURE__*/_jsx(\"button\",{onClick:handleSendMessage,disabled:!inputMessage.trim()||isLoading,className:\"p-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors\",title:\"Send message\",children:/*#__PURE__*/_jsx(Send,{className:\"w-5 h-5\"})})]})]}),isListening&&/*#__PURE__*/_jsx(\"div\",{className:\"mt-2 text-center\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"inline-flex items-center space-x-2 text-sm text-blue-600\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-2 h-2 bg-blue-500 rounded-full animate-pulse\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Listening... Speak now\"})]})})]})]});}","map":{"version":3,"names":["React","useState","useEffect","useRef","motion","AnimatePresence","Send","Mic","MicOff","Volume2","VolumeX","Bot","User","Loader2","botpressService","useStore","jsx","_jsx","jsxs","_jsxs","BotpressChat","_ref","onMessage","onSpeaking","user","addMessage","messages","isListening","startListening","stopListening","speakText","inputMessage","setInputMessage","isConnected","setIsConnected","isLoading","setIsLoading","isSpeaking","setIsSpeaking","isMuted","setIsMuted","messagesEndRef","speechSynthesis","initializeBotpress","scrollToBottom","initialize","greeting","getInitialGreeting","length","greetingMessage","id","userId","content","text","isFromUser","timestamp","Date","emotion","type","intensity","speakMessage","error","console","current","window","cancel","utterance","SpeechSynthesisUtterance","rate","pitch","volume","onstart","onend","onerror","speak","handleSendMessage","trim","userMessage","userMsg","concat","now","responses","sendMessage","response","botMsg","fallbackMsg","handleVoiceInput","handleKeyPress","e","key","shiftKey","preventDefault","_messagesEndRef$curre","scrollIntoView","behavior","toggleMute","className","children","onClick","title","map","message","div","initial","opacity","y","animate","exit","toLocaleTimeString","hour","minute","ref","value","onChange","target","onKeyPress","placeholder","rows","style","minHeight","maxHeight","disabled"],"sources":["/Users/jeetruia/MINDBLOOM/mindbloom-app/src/components/BotpressChat.tsx"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { Send, Mic, MicOff, Volume2, VolumeX, Bot, User, Loader2 } from 'lucide-react';\nimport { botpressService } from '../services/botpressService';\nimport { useStore } from '../hooks/useStore';\n\ninterface BotpressChatProps {\n  onMessage: (message: string, isFromUser: boolean) => void;\n  onSpeaking: (isSpeaking: boolean) => void;\n}\n\ninterface ChatMessage {\n  id: string;\n  content: string;\n  isFromUser: boolean;\n  timestamp: Date;\n  isTyping?: boolean;\n}\n\nexport function BotpressChat({ onMessage, onSpeaking }: BotpressChatProps) {\n  const { user, addMessage, messages, isListening, startListening, stopListening, speakText } = useStore();\n  const [inputMessage, setInputMessage] = useState('');\n  const [isConnected, setIsConnected] = useState(false);\n  const [isLoading, setIsLoading] = useState(false);\n  const [isSpeaking, setIsSpeaking] = useState(false);\n  const [isMuted, setIsMuted] = useState(false);\n  const messagesEndRef = useRef<HTMLDivElement>(null);\n  const speechSynthesis = useRef<SpeechSynthesisUtterance | null>(null);\n\n  useEffect(() => {\n    initializeBotpress();\n  }, []);\n\n  useEffect(() => {\n    scrollToBottom();\n  }, [messages]);\n\n  const initializeBotpress = async () => {\n    try {\n      await botpressService.initialize();\n      setIsConnected(true);\n      \n      // Get initial greeting from Botpress\n      const greeting = await botpressService.getInitialGreeting();\n      if (greeting && greeting.length > 0) {\n        const greetingMessage = greeting[0];\n        addMessage({\n          id: greetingMessage.id,\n          userId: user?.id || 'anonymous',\n          content: greetingMessage.text || 'Hello! I\\'m Mira, your wellness guide.',\n          isFromUser: false,\n          timestamp: new Date(),\n          emotion: { type: 'welcoming', intensity: 0.8 }\n        });\n        \n        // Speak the greeting\n        if (greetingMessage.text) {\n          speakMessage(greetingMessage.text);\n        }\n      }\n    } catch (error) {\n      console.error('Failed to initialize Botpress:', error);\n      setIsConnected(false);\n    }\n  };\n\n  const speakMessage = (text: string) => {\n    if (isMuted || isSpeaking) return;\n    \n    setIsSpeaking(true);\n    onSpeaking(true);\n    \n    // Stop any current speech\n    if (speechSynthesis.current) {\n      window.speechSynthesis.cancel();\n    }\n\n    const utterance = new SpeechSynthesisUtterance(text);\n    utterance.rate = 0.9;\n    utterance.pitch = 1.1;\n    utterance.volume = 0.8;\n    \n    utterance.onstart = () => {\n      setIsSpeaking(true);\n      onSpeaking(true);\n    };\n    \n    utterance.onend = () => {\n      setIsSpeaking(false);\n      onSpeaking(false);\n    };\n    \n    utterance.onerror = () => {\n      setIsSpeaking(false);\n      onSpeaking(false);\n    };\n\n    speechSynthesis.current = utterance;\n    speechSynthesis.speak(utterance);\n  };\n\n  const handleSendMessage = async () => {\n    if (!inputMessage.trim() || isLoading) return;\n\n    const userMessage = inputMessage.trim();\n    setInputMessage('');\n    setIsLoading(true);\n\n    // Add user message\n    const userMsg = {\n      id: `user_${Date.now()}`,\n      userId: user?.id || 'anonymous',\n      content: userMessage,\n      isFromUser: true,\n      timestamp: new Date(),\n      emotion: { type: 'neutral', intensity: 0.5 }\n    };\n    \n    addMessage(userMsg);\n    onMessage(userMessage, true);\n\n    try {\n      // Send to Botpress\n      const responses = await botpressService.sendMessage(userMessage);\n      \n      if (responses && responses.length > 0) {\n        for (const response of responses) {\n          if (response.text) {\n            const botMsg = {\n              id: response.id,\n              userId: user?.id || 'anonymous',\n              content: response.text,\n              isFromUser: false,\n              timestamp: new Date(),\n              emotion: { type: 'encouraging', intensity: 0.7 }\n            };\n            \n            addMessage(botMsg);\n            onMessage(response.text, false);\n            \n            // Speak the response\n            speakMessage(response.text);\n          }\n        }\n      }\n    } catch (error) {\n      console.error('Error sending message to Botpress:', error);\n      \n      // Fallback response\n      const fallbackMsg = {\n        id: `fallback_${Date.now()}`,\n        userId: user?.id || 'anonymous',\n        content: \"I'm here to listen and support you. How are you feeling today?\",\n        isFromUser: false,\n        timestamp: new Date(),\n        emotion: { type: 'encouraging', intensity: 0.6 }\n      };\n      \n      addMessage(fallbackMsg);\n      onMessage(fallbackMsg.content, false);\n      speakMessage(fallbackMsg.content);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const handleVoiceInput = () => {\n    if (isListening) {\n      stopListening();\n    } else {\n      startListening();\n    }\n  };\n\n  const handleKeyPress = (e: React.KeyboardEvent) => {\n    if (e.key === 'Enter' && !e.shiftKey) {\n      e.preventDefault();\n      handleSendMessage();\n    }\n  };\n\n  const scrollToBottom = () => {\n    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });\n  };\n\n  const toggleMute = () => {\n    setIsMuted(!isMuted);\n    if (isSpeaking) {\n      speechSynthesis.cancel();\n      setIsSpeaking(false);\n      onSpeaking(false);\n    }\n  };\n\n  return (\n    <div className=\"flex flex-col h-full bg-white\">\n      {/* Header */}\n      <div className=\"p-4 border-b border-gray-200 bg-gradient-to-r from-blue-500 to-purple-500 text-white\">\n        <div className=\"flex items-center justify-between\">\n          <div className=\"flex items-center space-x-3\">\n            <div className=\"w-10 h-10 bg-white/20 rounded-full flex items-center justify-center\">\n              <Bot className=\"w-6 h-6\" />\n            </div>\n            <div>\n              <h3 className=\"font-semibold\">Mira - Your Wellness Guide</h3>\n              <p className=\"text-sm text-white/80\">\n                {isConnected ? 'Connected' : 'Connecting...'}\n              </p>\n            </div>\n          </div>\n          <div className=\"flex items-center space-x-2\">\n            <button\n              onClick={toggleMute}\n              className={`p-2 rounded-lg transition-colors ${\n                isMuted ? 'bg-red-500/20 text-red-200' : 'bg-white/20 text-white'\n              }`}\n              title={isMuted ? 'Unmute' : 'Mute'}\n            >\n              {isMuted ? <VolumeX className=\"w-4 h-4\" /> : <Volume2 className=\"w-4 h-4\" />}\n            </button>\n            {isSpeaking && (\n              <div className=\"flex items-center space-x-1 text-white/80\">\n                <div className=\"w-2 h-2 bg-white rounded-full animate-pulse\"></div>\n                <span className=\"text-xs\">Speaking</span>\n              </div>\n            )}\n          </div>\n        </div>\n      </div>\n\n      {/* Messages */}\n      <div className=\"flex-1 overflow-y-auto p-4 space-y-4\">\n        <AnimatePresence>\n          {messages.map((message) => (\n            <motion.div\n              key={message.id}\n              initial={{ opacity: 0, y: 20 }}\n              animate={{ opacity: 1, y: 0 }}\n              exit={{ opacity: 0, y: -20 }}\n              className={`flex ${message.isFromUser ? 'justify-end' : 'justify-start'}`}\n            >\n              <div\n                className={`max-w-xs lg:max-w-md px-4 py-2 rounded-2xl ${\n                  message.isFromUser\n                    ? 'bg-blue-500 text-white'\n                    : 'bg-gray-100 text-gray-800'\n                }`}\n              >\n                <div className=\"flex items-start space-x-2\">\n                  {!message.isFromUser && (\n                    <div className=\"w-6 h-6 bg-gradient-to-br from-blue-400 to-purple-400 rounded-full flex items-center justify-center flex-shrink-0 mt-1\">\n                      <Bot className=\"w-3 h-3 text-white\" />\n                    </div>\n                  )}\n                  <div className=\"flex-1\">\n                    <p className=\"text-sm\">{message.content}</p>\n                    <p className=\"text-xs opacity-70 mt-1\">\n                      {message.timestamp.toLocaleTimeString([], { \n                        hour: '2-digit', \n                        minute: '2-digit' \n                      })}\n                    </p>\n                  </div>\n                  {message.isFromUser && (\n                    <div className=\"w-6 h-6 bg-gradient-to-br from-green-400 to-blue-400 rounded-full flex items-center justify-center flex-shrink-0 mt-1\">\n                      <User className=\"w-3 h-3 text-white\" />\n                    </div>\n                  )}\n                </div>\n              </div>\n            </motion.div>\n          ))}\n        </AnimatePresence>\n        \n        {isLoading && (\n          <motion.div\n            initial={{ opacity: 0, y: 20 }}\n            animate={{ opacity: 1, y: 0 }}\n            className=\"flex justify-start\"\n          >\n            <div className=\"bg-gray-100 text-gray-800 px-4 py-2 rounded-2xl\">\n              <div className=\"flex items-center space-x-2\">\n                <Loader2 className=\"w-4 h-4 animate-spin\" />\n                <span className=\"text-sm\">Mira is thinking...</span>\n              </div>\n            </div>\n          </motion.div>\n        )}\n        \n        <div ref={messagesEndRef} />\n      </div>\n\n      {/* Input */}\n      <div className=\"p-4 border-t border-gray-200 bg-gray-50\">\n        <div className=\"flex items-end space-x-2\">\n          <div className=\"flex-1\">\n            <textarea\n              value={inputMessage}\n              onChange={(e) => setInputMessage(e.target.value)}\n              onKeyPress={handleKeyPress}\n              placeholder=\"Type your message...\"\n              className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none\"\n              rows={1}\n              style={{ minHeight: '40px', maxHeight: '120px' }}\n            />\n          </div>\n          <div className=\"flex space-x-2\">\n            <button\n              onClick={handleVoiceInput}\n              className={`p-2 rounded-lg transition-colors ${\n                isListening\n                  ? 'bg-red-500 text-white'\n                  : 'bg-gray-200 text-gray-600 hover:bg-gray-300'\n              }`}\n              title={isListening ? 'Stop listening' : 'Start voice input'}\n            >\n              {isListening ? <MicOff className=\"w-5 h-5\" /> : <Mic className=\"w-5 h-5\" />}\n            </button>\n            <button\n              onClick={handleSendMessage}\n              disabled={!inputMessage.trim() || isLoading}\n              className=\"p-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors\"\n              title=\"Send message\"\n            >\n              <Send className=\"w-5 h-5\" />\n            </button>\n          </div>\n        </div>\n        \n        {isListening && (\n          <div className=\"mt-2 text-center\">\n            <div className=\"inline-flex items-center space-x-2 text-sm text-blue-600\">\n              <div className=\"w-2 h-2 bg-blue-500 rounded-full animate-pulse\"></div>\n              <span>Listening... Speak now</span>\n            </div>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}