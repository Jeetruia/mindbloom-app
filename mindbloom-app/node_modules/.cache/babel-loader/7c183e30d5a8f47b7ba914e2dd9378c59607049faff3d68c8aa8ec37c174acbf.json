{"ast":null,"code":"import _objectSpread from\"/Users/jeetruia/MINDBLOOM/mindbloom-app/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import{create}from'zustand';import{persist}from'zustand/middleware';import{TTSService}from'../services/speechServiceSimple';import{botpressService}from'../services/botpressService';const CRISIS_KEYWORDS={critical:['suicide','kill myself','end it all','not worth living','want to die'],high:['depressed','hopeless','worthless','can\\'t go on','give up'],medium:['sad','lonely','anxious','worried','stressed'],low:['tired','overwhelmed','difficult','challenging']};export const useStore=create()(persist((set,get)=>({// Initial state\nuser:null,isLoading:true,messages:[],isTyping:false,avatarState:{isVisible:false,isSpeaking:false,currentAnimation:'idle',emotion:{type:'neutral',intensity:0.5},position:{x:0,y:0,z:0}},crisisDetected:null,sessions:[],ttsService:new TTSService(),botpressConnected:false,hasShownInitialGreeting:false,// Actions\nsetUser:user=>set({user}),addMessage:message=>set(state=>({messages:[...state.messages,message]})),setTyping:isTyping=>set({isTyping}),updateAvatarState:newState=>set(state=>({avatarState:_objectSpread(_objectSpread({},state.avatarState),newState)})),setCrisisDetected:crisis=>set({crisisDetected:crisis}),addSession:session=>set(state=>({sessions:[...state.sessions,session]})),initializeApp:async()=>{set({isLoading:true});try{// Check for existing user in localStorage\nconst savedUser=localStorage.getItem('mindbloom-user');if(savedUser){const user=JSON.parse(savedUser);set({user,isLoading:false});}else{set({isLoading:false});}}catch(error){console.error('Error initializing app:',error);set({isLoading:false});}},sendMessage:async content=>{const{user,addMessage,setTyping,processCrisisDetection,setCrisisDetected,botpressConnected}=get();if(!user)return;// Add user message\nconst userMessage={id:Date.now().toString(),userId:user.id,content,isFromUser:true,timestamp:new Date()};addMessage(userMessage);// Check for crisis keywords\nconst crisis=processCrisisDetection(content);if(crisis){setCrisisDetected(crisis);}setTyping(true);try{let aiResponse='';if(botpressConnected){// Use Botpress for AI response\nconst botpressMessages=await botpressService.sendMessage(content);if(botpressMessages.length>0){aiResponse=botpressMessages[0].text||'';}}// Fallback to local AI if Botpress fails or not connected\nif(!aiResponse){aiResponse=generateAIResponse(content,crisis);}const aiMessage={id:(Date.now()+1).toString(),userId:'ai',content:aiResponse,isFromUser:false,timestamp:new Date(),emotion:{type:'encouraging',intensity:0.8}};addMessage(aiMessage);// Update avatar to speak and use TTS\nget().updateAvatarState({isSpeaking:true,currentAnimation:'speaking',emotion:{type:'encouraging',intensity:0.8}});// Use TTS to speak the response\ntry{await get().speakText(aiResponse);}catch(error){console.warn('TTS failed:',error);}// Stop speaking after TTS completes\nget().updateAvatarState({isSpeaking:false,currentAnimation:'idle'});}catch(error){console.error('Error sending message:',error);}finally{setTyping(false);}},processCrisisDetection:message=>{const lowerMessage=message.toLowerCase();for(const[severity,keywords]of Object.entries(CRISIS_KEYWORDS)){for(const keyword of keywords){if(lowerMessage.includes(keyword)){return{keywords:[keyword],severity:severity,action:severity==='critical'?'emergency':severity==='high'?'escalate':'monitor'};}}}return null;},speakText:async text=>{const{ttsService}=get();try{await ttsService.speak(text,{rate:0.9,pitch:1.0,volume:0.8});}catch(error){console.error('TTS Error:',error);throw error;}},initializeBotpress:async()=>{try{await botpressService.initialize();set({botpressConnected:true});console.log('Botpress initialized successfully');}catch(error){console.error('Failed to initialize Botpress:',error);set({botpressConnected:false});}},showInitialGreeting:async()=>{const{hasShownInitialGreeting,addMessage,updateAvatarState,speakText,botpressConnected}=get();if(hasShownInitialGreeting)return;try{let greetingText='';if(botpressConnected){const botpressMessages=await botpressService.getInitialGreeting();if(botpressMessages.length>0){greetingText=botpressMessages[0].text||'';}}// Fallback greeting\nif(!greetingText){greetingText=\"Hello! I'm Mira, your wellness guide. I'm here to listen and support you. How are you feeling today?\";}const greetingMessage={id:\"greeting_\".concat(Date.now()),userId:'ai',content:greetingText,isFromUser:false,timestamp:new Date(),emotion:{type:'welcoming',intensity:0.9}};addMessage(greetingMessage);// Update avatar to speak\nupdateAvatarState({isSpeaking:true,currentAnimation:'speaking',emotion:{type:'welcoming',intensity:0.9}});// Speak the greeting\ntry{await speakText(greetingText);}catch(error){console.warn('TTS failed for greeting:',error);}// Stop speaking\nupdateAvatarState({isSpeaking:false,currentAnimation:'idle'});set({hasShownInitialGreeting:true});}catch(error){console.error('Error showing initial greeting:',error);}},setBotpressConnected:connected=>set({botpressConnected:connected})}),{name:'mindbloom-storage',partialize:state=>({user:state.user,sessions:state.sessions})}));// Helper function to generate AI responses\nfunction generateAIResponse(userMessage,crisis){if(crisis){switch(crisis.severity){case'critical':return\"I'm really concerned about what you're sharing. Your safety is the most important thing right now. Please reach out to a crisis helpline immediately. In the US, you can call 988 for the Suicide & Crisis Lifeline. You're not alone, and there are people who want to help you.\";case'high':return\"I can hear that you're going through a really difficult time right now. It takes courage to share these feelings. While I'm here to listen and support you, I want to encourage you to also reach out to a mental health professional or trusted person in your life. You deserve support.\";case'medium':return\"I understand you're feeling overwhelmed right now. These feelings are valid, and it's okay to not be okay sometimes. Let's work together to find some strategies that might help you feel a bit better. Would you like to try a breathing exercise or talk about what's on your mind?\";default:return\"I hear you, and I'm here to support you through this. Sometimes life can feel really challenging, but you're taking a positive step by reaching out. Let's explore some ways we can work through this together.\";}}// Generate empathetic responses based on common patterns\nconst responses=[\"I really appreciate you sharing that with me. It sounds like you're dealing with a lot right now.\",\"That sounds really challenging. I'm here to listen and support you through this.\",\"I can hear the strength in your words, even when things feel difficult. You're doing better than you might think.\",\"Thank you for trusting me with your thoughts. Let's work together to find some strategies that might help.\",\"I understand this is hard for you. Remember, it's okay to take things one step at a time.\",\"Your feelings are completely valid. Sometimes just talking about what's on our mind can help us feel a bit lighter.\"];return responses[Math.floor(Math.random()*responses.length)];}","map":{"version":3,"names":["create","persist","TTSService","botpressService","CRISIS_KEYWORDS","critical","high","medium","low","useStore","set","get","user","isLoading","messages","isTyping","avatarState","isVisible","isSpeaking","currentAnimation","emotion","type","intensity","position","x","y","z","crisisDetected","sessions","ttsService","botpressConnected","hasShownInitialGreeting","setUser","addMessage","message","state","setTyping","updateAvatarState","newState","_objectSpread","setCrisisDetected","crisis","addSession","session","initializeApp","savedUser","localStorage","getItem","JSON","parse","error","console","sendMessage","content","processCrisisDetection","userMessage","id","Date","now","toString","userId","isFromUser","timestamp","aiResponse","botpressMessages","length","text","generateAIResponse","aiMessage","speakText","warn","lowerMessage","toLowerCase","severity","keywords","Object","entries","keyword","includes","action","speak","rate","pitch","volume","initializeBotpress","initialize","log","showInitialGreeting","greetingText","getInitialGreeting","greetingMessage","concat","setBotpressConnected","connected","name","partialize","responses","Math","floor","random"],"sources":["/Users/jeetruia/MINDBLOOM/mindbloom-app/src/hooks/useStore.ts"],"sourcesContent":["import { create } from 'zustand';\nimport { persist } from 'zustand/middleware';\nimport { User, ChatMessage, AvatarState, CrisisDetection, WellnessSession } from '../types';\nimport { TTSService } from '../services/speechServiceSimple';\nimport { botpressService } from '../services/botpressService';\n\ninterface AppState {\n  // User state\n  user: User | null;\n  isLoading: boolean;\n  \n  // Chat state\n  messages: ChatMessage[];\n  isTyping: boolean;\n  \n  // Avatar state\n  avatarState: AvatarState;\n  \n  // Crisis detection\n  crisisDetected: CrisisDetection | null;\n  \n  // Sessions\n  sessions: WellnessSession[];\n  \n  // Speech service\n  ttsService: TTSService;\n  \n  // Botpress state\n  botpressConnected: boolean;\n  hasShownInitialGreeting: boolean;\n  \n  // Actions\n  setUser: (user: User) => void;\n  addMessage: (message: ChatMessage) => void;\n  setTyping: (isTyping: boolean) => void;\n  updateAvatarState: (state: Partial<AvatarState>) => void;\n  setCrisisDetected: (crisis: CrisisDetection | null) => void;\n  addSession: (session: WellnessSession) => void;\n  initializeApp: () => Promise<void>;\n  sendMessage: (content: string) => Promise<void>;\n  processCrisisDetection: (message: string) => CrisisDetection | null;\n  speakText: (text: string) => Promise<void>;\n  initializeBotpress: () => Promise<void>;\n  showInitialGreeting: () => Promise<void>;\n  setBotpressConnected: (connected: boolean) => void;\n}\n\nconst CRISIS_KEYWORDS = {\n  critical: ['suicide', 'kill myself', 'end it all', 'not worth living', 'want to die'],\n  high: ['depressed', 'hopeless', 'worthless', 'can\\'t go on', 'give up'],\n  medium: ['sad', 'lonely', 'anxious', 'worried', 'stressed'],\n  low: ['tired', 'overwhelmed', 'difficult', 'challenging']\n};\n\nexport const useStore = create<AppState>()(\n  persist(\n    (set, get) => ({\n      // Initial state\n      user: null,\n      isLoading: true,\n      messages: [],\n      isTyping: false,\n      avatarState: {\n        isVisible: false,\n        isSpeaking: false,\n        currentAnimation: 'idle',\n        emotion: { type: 'neutral', intensity: 0.5 },\n        position: { x: 0, y: 0, z: 0 }\n      },\n      crisisDetected: null,\n      sessions: [],\n      ttsService: new TTSService(),\n      botpressConnected: false,\n      hasShownInitialGreeting: false,\n\n      // Actions\n      setUser: (user) => set({ user }),\n      \n      addMessage: (message) => set((state) => ({\n        messages: [...state.messages, message]\n      })),\n      \n      setTyping: (isTyping) => set({ isTyping }),\n      \n      updateAvatarState: (newState) => set((state) => ({\n        avatarState: { ...state.avatarState, ...newState }\n      })),\n      \n      setCrisisDetected: (crisis) => set({ crisisDetected: crisis }),\n      \n      addSession: (session) => set((state) => ({\n        sessions: [...state.sessions, session]\n      })),\n\n      initializeApp: async () => {\n        set({ isLoading: true });\n        \n        try {\n          // Check for existing user in localStorage\n          const savedUser = localStorage.getItem('mindbloom-user');\n          if (savedUser) {\n            const user = JSON.parse(savedUser);\n            set({ user, isLoading: false });\n          } else {\n            set({ isLoading: false });\n          }\n        } catch (error) {\n          console.error('Error initializing app:', error);\n          set({ isLoading: false });\n        }\n      },\n\n      sendMessage: async (content) => {\n        const { user, addMessage, setTyping, processCrisisDetection, setCrisisDetected, botpressConnected } = get();\n        \n        if (!user) return;\n\n        // Add user message\n        const userMessage: ChatMessage = {\n          id: Date.now().toString(),\n          userId: user.id,\n          content,\n          isFromUser: true,\n          timestamp: new Date()\n        };\n        addMessage(userMessage);\n\n        // Check for crisis keywords\n        const crisis = processCrisisDetection(content);\n        if (crisis) {\n          setCrisisDetected(crisis);\n        }\n\n        setTyping(true);\n\n        try {\n          let aiResponse = '';\n          \n          if (botpressConnected) {\n            // Use Botpress for AI response\n            const botpressMessages = await botpressService.sendMessage(content);\n            if (botpressMessages.length > 0) {\n              aiResponse = botpressMessages[0].text || '';\n            }\n          }\n          \n          // Fallback to local AI if Botpress fails or not connected\n          if (!aiResponse) {\n            aiResponse = generateAIResponse(content, crisis);\n          }\n          \n          const aiMessage: ChatMessage = {\n            id: (Date.now() + 1).toString(),\n            userId: 'ai',\n            content: aiResponse,\n            isFromUser: false,\n            timestamp: new Date(),\n            emotion: { type: 'encouraging', intensity: 0.8 }\n          };\n          \n          addMessage(aiMessage);\n          \n          // Update avatar to speak and use TTS\n          get().updateAvatarState({\n            isSpeaking: true,\n            currentAnimation: 'speaking',\n            emotion: { type: 'encouraging', intensity: 0.8 }\n          });\n\n          // Use TTS to speak the response\n          try {\n            await get().speakText(aiResponse);\n          } catch (error) {\n            console.warn('TTS failed:', error);\n          }\n\n          // Stop speaking after TTS completes\n          get().updateAvatarState({\n            isSpeaking: false,\n            currentAnimation: 'idle'\n          });\n\n        } catch (error) {\n          console.error('Error sending message:', error);\n        } finally {\n          setTyping(false);\n        }\n      },\n\n      processCrisisDetection: (message) => {\n        const lowerMessage = message.toLowerCase();\n        \n        for (const [severity, keywords] of Object.entries(CRISIS_KEYWORDS)) {\n          for (const keyword of keywords) {\n            if (lowerMessage.includes(keyword)) {\n              return {\n                keywords: [keyword],\n                severity: severity as CrisisDetection['severity'],\n                action: severity === 'critical' ? 'emergency' : \n                       severity === 'high' ? 'escalate' : 'monitor'\n              };\n            }\n          }\n        }\n        \n        return null;\n      },\n\n      speakText: async (text) => {\n        const { ttsService } = get();\n        try {\n          await ttsService.speak(text, {\n            rate: 0.9,\n            pitch: 1.0,\n            volume: 0.8\n          });\n        } catch (error) {\n          console.error('TTS Error:', error);\n          throw error;\n        }\n      },\n\n      initializeBotpress: async () => {\n        try {\n          await botpressService.initialize();\n          set({ botpressConnected: true });\n          console.log('Botpress initialized successfully');\n        } catch (error) {\n          console.error('Failed to initialize Botpress:', error);\n          set({ botpressConnected: false });\n        }\n      },\n\n      showInitialGreeting: async () => {\n        const { hasShownInitialGreeting, addMessage, updateAvatarState, speakText, botpressConnected } = get();\n        \n        if (hasShownInitialGreeting) return;\n\n        try {\n          let greetingText = '';\n          \n          if (botpressConnected) {\n            const botpressMessages = await botpressService.getInitialGreeting();\n            if (botpressMessages.length > 0) {\n              greetingText = botpressMessages[0].text || '';\n            }\n          }\n          \n          // Fallback greeting\n          if (!greetingText) {\n            greetingText = \"Hello! I'm Mira, your wellness guide. I'm here to listen and support you. How are you feeling today?\";\n          }\n\n          const greetingMessage: ChatMessage = {\n            id: `greeting_${Date.now()}`,\n            userId: 'ai',\n            content: greetingText,\n            isFromUser: false,\n            timestamp: new Date(),\n            emotion: { type: 'welcoming', intensity: 0.9 }\n          };\n\n          addMessage(greetingMessage);\n\n          // Update avatar to speak\n          updateAvatarState({\n            isSpeaking: true,\n            currentAnimation: 'speaking',\n            emotion: { type: 'welcoming', intensity: 0.9 }\n          });\n\n          // Speak the greeting\n          try {\n            await speakText(greetingText);\n          } catch (error) {\n            console.warn('TTS failed for greeting:', error);\n          }\n\n          // Stop speaking\n          updateAvatarState({\n            isSpeaking: false,\n            currentAnimation: 'idle'\n          });\n\n          set({ hasShownInitialGreeting: true });\n        } catch (error) {\n          console.error('Error showing initial greeting:', error);\n        }\n      },\n\n      setBotpressConnected: (connected) => set({ botpressConnected: connected })\n    }),\n    {\n      name: 'mindbloom-storage',\n      partialize: (state) => ({\n        user: state.user,\n        sessions: state.sessions\n      })\n    }\n  )\n);\n\n// Helper function to generate AI responses\nfunction generateAIResponse(userMessage: string, crisis: CrisisDetection | null): string {\n  if (crisis) {\n    switch (crisis.severity) {\n      case 'critical':\n        return \"I'm really concerned about what you're sharing. Your safety is the most important thing right now. Please reach out to a crisis helpline immediately. In the US, you can call 988 for the Suicide & Crisis Lifeline. You're not alone, and there are people who want to help you.\";\n      case 'high':\n        return \"I can hear that you're going through a really difficult time right now. It takes courage to share these feelings. While I'm here to listen and support you, I want to encourage you to also reach out to a mental health professional or trusted person in your life. You deserve support.\";\n      case 'medium':\n        return \"I understand you're feeling overwhelmed right now. These feelings are valid, and it's okay to not be okay sometimes. Let's work together to find some strategies that might help you feel a bit better. Would you like to try a breathing exercise or talk about what's on your mind?\";\n      default:\n        return \"I hear you, and I'm here to support you through this. Sometimes life can feel really challenging, but you're taking a positive step by reaching out. Let's explore some ways we can work through this together.\";\n    }\n  }\n\n  // Generate empathetic responses based on common patterns\n  const responses = [\n    \"I really appreciate you sharing that with me. It sounds like you're dealing with a lot right now.\",\n    \"That sounds really challenging. I'm here to listen and support you through this.\",\n    \"I can hear the strength in your words, even when things feel difficult. You're doing better than you might think.\",\n    \"Thank you for trusting me with your thoughts. Let's work together to find some strategies that might help.\",\n    \"I understand this is hard for you. Remember, it's okay to take things one step at a time.\",\n    \"Your feelings are completely valid. Sometimes just talking about what's on our mind can help us feel a bit lighter.\"\n  ];\n\n  return responses[Math.floor(Math.random() * responses.length)];\n}\n"],"mappings":"4HAAA,OAASA,MAAM,KAAQ,SAAS,CAChC,OAASC,OAAO,KAAQ,oBAAoB,CAE5C,OAASC,UAAU,KAAQ,iCAAiC,CAC5D,OAASC,eAAe,KAAQ,6BAA6B,CA2C7D,KAAM,CAAAC,eAAe,CAAG,CACtBC,QAAQ,CAAE,CAAC,SAAS,CAAE,aAAa,CAAE,YAAY,CAAE,kBAAkB,CAAE,aAAa,CAAC,CACrFC,IAAI,CAAE,CAAC,WAAW,CAAE,UAAU,CAAE,WAAW,CAAE,cAAc,CAAE,SAAS,CAAC,CACvEC,MAAM,CAAE,CAAC,KAAK,CAAE,QAAQ,CAAE,SAAS,CAAE,SAAS,CAAE,UAAU,CAAC,CAC3DC,GAAG,CAAE,CAAC,OAAO,CAAE,aAAa,CAAE,WAAW,CAAE,aAAa,CAC1D,CAAC,CAED,MAAO,MAAM,CAAAC,QAAQ,CAAGT,MAAM,CAAW,CAAC,CACxCC,OAAO,CACL,CAACS,GAAG,CAAEC,GAAG,IAAM,CACb;AACAC,IAAI,CAAE,IAAI,CACVC,SAAS,CAAE,IAAI,CACfC,QAAQ,CAAE,EAAE,CACZC,QAAQ,CAAE,KAAK,CACfC,WAAW,CAAE,CACXC,SAAS,CAAE,KAAK,CAChBC,UAAU,CAAE,KAAK,CACjBC,gBAAgB,CAAE,MAAM,CACxBC,OAAO,CAAE,CAAEC,IAAI,CAAE,SAAS,CAAEC,SAAS,CAAE,GAAI,CAAC,CAC5CC,QAAQ,CAAE,CAAEC,CAAC,CAAE,CAAC,CAAEC,CAAC,CAAE,CAAC,CAAEC,CAAC,CAAE,CAAE,CAC/B,CAAC,CACDC,cAAc,CAAE,IAAI,CACpBC,QAAQ,CAAE,EAAE,CACZC,UAAU,CAAE,GAAI,CAAA3B,UAAU,CAAC,CAAC,CAC5B4B,iBAAiB,CAAE,KAAK,CACxBC,uBAAuB,CAAE,KAAK,CAE9B;AACAC,OAAO,CAAGpB,IAAI,EAAKF,GAAG,CAAC,CAAEE,IAAK,CAAC,CAAC,CAEhCqB,UAAU,CAAGC,OAAO,EAAKxB,GAAG,CAAEyB,KAAK,GAAM,CACvCrB,QAAQ,CAAE,CAAC,GAAGqB,KAAK,CAACrB,QAAQ,CAAEoB,OAAO,CACvC,CAAC,CAAC,CAAC,CAEHE,SAAS,CAAGrB,QAAQ,EAAKL,GAAG,CAAC,CAAEK,QAAS,CAAC,CAAC,CAE1CsB,iBAAiB,CAAGC,QAAQ,EAAK5B,GAAG,CAAEyB,KAAK,GAAM,CAC/CnB,WAAW,CAAAuB,aAAA,CAAAA,aAAA,IAAOJ,KAAK,CAACnB,WAAW,EAAKsB,QAAQ,CAClD,CAAC,CAAC,CAAC,CAEHE,iBAAiB,CAAGC,MAAM,EAAK/B,GAAG,CAAC,CAAEiB,cAAc,CAAEc,MAAO,CAAC,CAAC,CAE9DC,UAAU,CAAGC,OAAO,EAAKjC,GAAG,CAAEyB,KAAK,GAAM,CACvCP,QAAQ,CAAE,CAAC,GAAGO,KAAK,CAACP,QAAQ,CAAEe,OAAO,CACvC,CAAC,CAAC,CAAC,CAEHC,aAAa,CAAE,KAAAA,CAAA,GAAY,CACzBlC,GAAG,CAAC,CAAEG,SAAS,CAAE,IAAK,CAAC,CAAC,CAExB,GAAI,CACF;AACA,KAAM,CAAAgC,SAAS,CAAGC,YAAY,CAACC,OAAO,CAAC,gBAAgB,CAAC,CACxD,GAAIF,SAAS,CAAE,CACb,KAAM,CAAAjC,IAAI,CAAGoC,IAAI,CAACC,KAAK,CAACJ,SAAS,CAAC,CAClCnC,GAAG,CAAC,CAAEE,IAAI,CAAEC,SAAS,CAAE,KAAM,CAAC,CAAC,CACjC,CAAC,IAAM,CACLH,GAAG,CAAC,CAAEG,SAAS,CAAE,KAAM,CAAC,CAAC,CAC3B,CACF,CAAE,MAAOqC,KAAK,CAAE,CACdC,OAAO,CAACD,KAAK,CAAC,yBAAyB,CAAEA,KAAK,CAAC,CAC/CxC,GAAG,CAAC,CAAEG,SAAS,CAAE,KAAM,CAAC,CAAC,CAC3B,CACF,CAAC,CAEDuC,WAAW,CAAE,KAAO,CAAAC,OAAO,EAAK,CAC9B,KAAM,CAAEzC,IAAI,CAAEqB,UAAU,CAAEG,SAAS,CAAEkB,sBAAsB,CAAEd,iBAAiB,CAAEV,iBAAkB,CAAC,CAAGnB,GAAG,CAAC,CAAC,CAE3G,GAAI,CAACC,IAAI,CAAE,OAEX;AACA,KAAM,CAAA2C,WAAwB,CAAG,CAC/BC,EAAE,CAAEC,IAAI,CAACC,GAAG,CAAC,CAAC,CAACC,QAAQ,CAAC,CAAC,CACzBC,MAAM,CAAEhD,IAAI,CAAC4C,EAAE,CACfH,OAAO,CACPQ,UAAU,CAAE,IAAI,CAChBC,SAAS,CAAE,GAAI,CAAAL,IAAI,CAAC,CACtB,CAAC,CACDxB,UAAU,CAACsB,WAAW,CAAC,CAEvB;AACA,KAAM,CAAAd,MAAM,CAAGa,sBAAsB,CAACD,OAAO,CAAC,CAC9C,GAAIZ,MAAM,CAAE,CACVD,iBAAiB,CAACC,MAAM,CAAC,CAC3B,CAEAL,SAAS,CAAC,IAAI,CAAC,CAEf,GAAI,CACF,GAAI,CAAA2B,UAAU,CAAG,EAAE,CAEnB,GAAIjC,iBAAiB,CAAE,CACrB;AACA,KAAM,CAAAkC,gBAAgB,CAAG,KAAM,CAAA7D,eAAe,CAACiD,WAAW,CAACC,OAAO,CAAC,CACnE,GAAIW,gBAAgB,CAACC,MAAM,CAAG,CAAC,CAAE,CAC/BF,UAAU,CAAGC,gBAAgB,CAAC,CAAC,CAAC,CAACE,IAAI,EAAI,EAAE,CAC7C,CACF,CAEA;AACA,GAAI,CAACH,UAAU,CAAE,CACfA,UAAU,CAAGI,kBAAkB,CAACd,OAAO,CAAEZ,MAAM,CAAC,CAClD,CAEA,KAAM,CAAA2B,SAAsB,CAAG,CAC7BZ,EAAE,CAAE,CAACC,IAAI,CAACC,GAAG,CAAC,CAAC,CAAG,CAAC,EAAEC,QAAQ,CAAC,CAAC,CAC/BC,MAAM,CAAE,IAAI,CACZP,OAAO,CAAEU,UAAU,CACnBF,UAAU,CAAE,KAAK,CACjBC,SAAS,CAAE,GAAI,CAAAL,IAAI,CAAC,CAAC,CACrBrC,OAAO,CAAE,CAAEC,IAAI,CAAE,aAAa,CAAEC,SAAS,CAAE,GAAI,CACjD,CAAC,CAEDW,UAAU,CAACmC,SAAS,CAAC,CAErB;AACAzD,GAAG,CAAC,CAAC,CAAC0B,iBAAiB,CAAC,CACtBnB,UAAU,CAAE,IAAI,CAChBC,gBAAgB,CAAE,UAAU,CAC5BC,OAAO,CAAE,CAAEC,IAAI,CAAE,aAAa,CAAEC,SAAS,CAAE,GAAI,CACjD,CAAC,CAAC,CAEF;AACA,GAAI,CACF,KAAM,CAAAX,GAAG,CAAC,CAAC,CAAC0D,SAAS,CAACN,UAAU,CAAC,CACnC,CAAE,MAAOb,KAAK,CAAE,CACdC,OAAO,CAACmB,IAAI,CAAC,aAAa,CAAEpB,KAAK,CAAC,CACpC,CAEA;AACAvC,GAAG,CAAC,CAAC,CAAC0B,iBAAiB,CAAC,CACtBnB,UAAU,CAAE,KAAK,CACjBC,gBAAgB,CAAE,MACpB,CAAC,CAAC,CAEJ,CAAE,MAAO+B,KAAK,CAAE,CACdC,OAAO,CAACD,KAAK,CAAC,wBAAwB,CAAEA,KAAK,CAAC,CAChD,CAAC,OAAS,CACRd,SAAS,CAAC,KAAK,CAAC,CAClB,CACF,CAAC,CAEDkB,sBAAsB,CAAGpB,OAAO,EAAK,CACnC,KAAM,CAAAqC,YAAY,CAAGrC,OAAO,CAACsC,WAAW,CAAC,CAAC,CAE1C,IAAK,KAAM,CAACC,QAAQ,CAAEC,QAAQ,CAAC,EAAI,CAAAC,MAAM,CAACC,OAAO,CAACxE,eAAe,CAAC,CAAE,CAClE,IAAK,KAAM,CAAAyE,OAAO,GAAI,CAAAH,QAAQ,CAAE,CAC9B,GAAIH,YAAY,CAACO,QAAQ,CAACD,OAAO,CAAC,CAAE,CAClC,MAAO,CACLH,QAAQ,CAAE,CAACG,OAAO,CAAC,CACnBJ,QAAQ,CAAEA,QAAuC,CACjDM,MAAM,CAAEN,QAAQ,GAAK,UAAU,CAAG,WAAW,CACtCA,QAAQ,GAAK,MAAM,CAAG,UAAU,CAAG,SAC5C,CAAC,CACH,CACF,CACF,CAEA,MAAO,KAAI,CACb,CAAC,CAEDJ,SAAS,CAAE,KAAO,CAAAH,IAAI,EAAK,CACzB,KAAM,CAAErC,UAAW,CAAC,CAAGlB,GAAG,CAAC,CAAC,CAC5B,GAAI,CACF,KAAM,CAAAkB,UAAU,CAACmD,KAAK,CAACd,IAAI,CAAE,CAC3Be,IAAI,CAAE,GAAG,CACTC,KAAK,CAAE,GAAG,CACVC,MAAM,CAAE,GACV,CAAC,CAAC,CACJ,CAAE,MAAOjC,KAAK,CAAE,CACdC,OAAO,CAACD,KAAK,CAAC,YAAY,CAAEA,KAAK,CAAC,CAClC,KAAM,CAAAA,KAAK,CACb,CACF,CAAC,CAEDkC,kBAAkB,CAAE,KAAAA,CAAA,GAAY,CAC9B,GAAI,CACF,KAAM,CAAAjF,eAAe,CAACkF,UAAU,CAAC,CAAC,CAClC3E,GAAG,CAAC,CAAEoB,iBAAiB,CAAE,IAAK,CAAC,CAAC,CAChCqB,OAAO,CAACmC,GAAG,CAAC,mCAAmC,CAAC,CAClD,CAAE,MAAOpC,KAAK,CAAE,CACdC,OAAO,CAACD,KAAK,CAAC,gCAAgC,CAAEA,KAAK,CAAC,CACtDxC,GAAG,CAAC,CAAEoB,iBAAiB,CAAE,KAAM,CAAC,CAAC,CACnC,CACF,CAAC,CAEDyD,mBAAmB,CAAE,KAAAA,CAAA,GAAY,CAC/B,KAAM,CAAExD,uBAAuB,CAAEE,UAAU,CAAEI,iBAAiB,CAAEgC,SAAS,CAAEvC,iBAAkB,CAAC,CAAGnB,GAAG,CAAC,CAAC,CAEtG,GAAIoB,uBAAuB,CAAE,OAE7B,GAAI,CACF,GAAI,CAAAyD,YAAY,CAAG,EAAE,CAErB,GAAI1D,iBAAiB,CAAE,CACrB,KAAM,CAAAkC,gBAAgB,CAAG,KAAM,CAAA7D,eAAe,CAACsF,kBAAkB,CAAC,CAAC,CACnE,GAAIzB,gBAAgB,CAACC,MAAM,CAAG,CAAC,CAAE,CAC/BuB,YAAY,CAAGxB,gBAAgB,CAAC,CAAC,CAAC,CAACE,IAAI,EAAI,EAAE,CAC/C,CACF,CAEA;AACA,GAAI,CAACsB,YAAY,CAAE,CACjBA,YAAY,CAAG,sGAAsG,CACvH,CAEA,KAAM,CAAAE,eAA4B,CAAG,CACnClC,EAAE,aAAAmC,MAAA,CAAclC,IAAI,CAACC,GAAG,CAAC,CAAC,CAAE,CAC5BE,MAAM,CAAE,IAAI,CACZP,OAAO,CAAEmC,YAAY,CACrB3B,UAAU,CAAE,KAAK,CACjBC,SAAS,CAAE,GAAI,CAAAL,IAAI,CAAC,CAAC,CACrBrC,OAAO,CAAE,CAAEC,IAAI,CAAE,WAAW,CAAEC,SAAS,CAAE,GAAI,CAC/C,CAAC,CAEDW,UAAU,CAACyD,eAAe,CAAC,CAE3B;AACArD,iBAAiB,CAAC,CAChBnB,UAAU,CAAE,IAAI,CAChBC,gBAAgB,CAAE,UAAU,CAC5BC,OAAO,CAAE,CAAEC,IAAI,CAAE,WAAW,CAAEC,SAAS,CAAE,GAAI,CAC/C,CAAC,CAAC,CAEF;AACA,GAAI,CACF,KAAM,CAAA+C,SAAS,CAACmB,YAAY,CAAC,CAC/B,CAAE,MAAOtC,KAAK,CAAE,CACdC,OAAO,CAACmB,IAAI,CAAC,0BAA0B,CAAEpB,KAAK,CAAC,CACjD,CAEA;AACAb,iBAAiB,CAAC,CAChBnB,UAAU,CAAE,KAAK,CACjBC,gBAAgB,CAAE,MACpB,CAAC,CAAC,CAEFT,GAAG,CAAC,CAAEqB,uBAAuB,CAAE,IAAK,CAAC,CAAC,CACxC,CAAE,MAAOmB,KAAK,CAAE,CACdC,OAAO,CAACD,KAAK,CAAC,iCAAiC,CAAEA,KAAK,CAAC,CACzD,CACF,CAAC,CAED0C,oBAAoB,CAAGC,SAAS,EAAKnF,GAAG,CAAC,CAAEoB,iBAAiB,CAAE+D,SAAU,CAAC,CAC3E,CAAC,CAAC,CACF,CACEC,IAAI,CAAE,mBAAmB,CACzBC,UAAU,CAAG5D,KAAK,GAAM,CACtBvB,IAAI,CAAEuB,KAAK,CAACvB,IAAI,CAChBgB,QAAQ,CAAEO,KAAK,CAACP,QAClB,CAAC,CACH,CACF,CACF,CAAC,CAED;AACA,QAAS,CAAAuC,kBAAkBA,CAACZ,WAAmB,CAAEd,MAA8B,CAAU,CACvF,GAAIA,MAAM,CAAE,CACV,OAAQA,MAAM,CAACgC,QAAQ,EACrB,IAAK,UAAU,CACb,MAAO,mRAAmR,CAC5R,IAAK,MAAM,CACT,MAAO,4RAA4R,CACrS,IAAK,QAAQ,CACX,MAAO,uRAAuR,CAChS,QACE,MAAO,iNAAiN,CAC5N,CACF,CAEA;AACA,KAAM,CAAAuB,SAAS,CAAG,CAChB,mGAAmG,CACnG,kFAAkF,CAClF,mHAAmH,CACnH,4GAA4G,CAC5G,2FAA2F,CAC3F,qHAAqH,CACtH,CAED,MAAO,CAAAA,SAAS,CAACC,IAAI,CAACC,KAAK,CAACD,IAAI,CAACE,MAAM,CAAC,CAAC,CAAGH,SAAS,CAAC/B,MAAM,CAAC,CAAC,CAChE","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}